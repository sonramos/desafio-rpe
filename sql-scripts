--- Create database structure ---

CREATE TABLE Cliente (
	idcliente int,
	nome varchar(255),
	idade int,
	statusbloqueio varchar(1),
	limitecredito float
);

CREATE TABLE Fatura (
	idfatura int,
	datavencimento date,
	valor float,
	status varchar(1)
);

CREATE TABLE Pagamento (
	idpagamento int,
	datapagamento date,
	valor float
);

select * from pagamento
select * from fatura
select * from cliente

--- Add FK columns ---

ALTER TABLE Fatura ADD COLUMN fk_Cliente_idcliente int;
ALTER TABLE Pagamento ADD COLUMN fk_Cliente_idcliente int;
ALTER TABLE Pagamento ADD COLUMN fk_Fatura_idfatura int;

--- Add PK and FK constraints ---

ALTER TABLE Cliente ADD CONSTRAINT PK_Cliente PRIMARY KEY(idcliente);
ALTER TABLE Fatura ADD CONSTRAINT PK_Fatura PRIMARY KEY(idfatura);
ALTER TABLE Fatura ADD CONSTRAINT FK_Cliente_Fatura FOREIGN KEY(fk_Cliente_idcliente) REFERENCES Cliente;
ALTER TABLE Pagamento ADD CONSTRAINT FK_Cliente_Pagamento FOREIGN KEY(fk_Cliente_idcliente) REFERENCES Cliente;
ALTER TABLE Pagamento ADD CONSTRAINT FK_Fatura_Pagamento FOREIGN KEY(fk_Fatura_idfatura) REFERENCES Fatura;
ALTER TABLE Pagamento ADD CONSTRAINT PK_Pagamento PRIMARY KEY (idpagamento, fk_Cliente_idcliente, fk_Fatura_idfatura);

--- INSERTS ---

INSERT INTO Cliente values(1,'John Doe',30,'0',3000.0)


